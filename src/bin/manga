#!/usr/bin/env python

import argparse
import logging
import sys

from animanager import requestlib
from animanager import configlib
from animanager.manga import commands

logging.basicConfig(level='DEBUG')

parser = argparse.ArgumentParser(
    prog="anime", add_help=False)
parser.add_argument('command', choices=commands.t_command)
parser.add_argument('args', nargs=argparse.REMAINDER)
parser.add_argument('--config')
args = parser.parse_args()

# load config
if args.config:
    config = args.config
else:
    config = configlib.default_config()
config = configlib.load_config(config)

# setup requestlib
requestlib.setup(config)

# run command
if args.command in commands.t_command:
    getattr(commands, args.command)(config, *args.args)
else:
    print('Command not found')
    sys.exit(1)
